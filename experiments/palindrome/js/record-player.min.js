(function(){function a(a){if(!$.isArray(a))throw"invalid_recording";var f=a.shift();if(!f||typeof f!="string")throw"invalid_recording";var g=a;if(!$.isArray(g))throw"invalid_recording";var h=f.split("");f=f.toLowerCase();var i=$('<div class="pal-widget">'),j=[];for(var k=0;k<h.length;k++){var l=b(h[k]);j.push(l),i.append(l.node)}var m=c(),n=d(),o=e();i.append(m.node),i.append(n.node),i.append(o.node),i.append('<div style="clear: both"></div>');var p=function(a){return a==a.split("").reverse().join("")},q=0,r={node:i,cmp:function(a,b,c){setTimeout(function(){c&&b-a>q&&p(f.substring(a,b+1))&&(q=b-a,r.longest(a,b)),a=j[a],b=j[b],c?a==b?a.good():(a.good(!0),b.good()):a==b?a.bad():(a.bad(!0),b.bad())},500)},"goto":function(a,b,c){return!j[a]||!j[b]?!1:(a<=b?n.moveTo(j[a],j[b]):n.moveTo(j[b],j[a]),r.cmp(a,b,c),!0)},longest:function(a,b){o.moveTo(j[a],j[b])},point:function(a){var b=a!=Math.floor(a);return a=Math.floor(a),j[a]?(m.point(j[a],b),!0):!1},fadeOut:function(){$(m.node).add(n.node).fadeOut()},play:function(){var a=function(){var b=g.shift();if(!b||!$.isArray(b)){r.fadeOut();return}var c=b[0],d=b.slice(1);c=="p"?(r.point(d[0]),setTimeout(a,1)):c=="c"&&(r.goto(d[0],d[1],d[2])?setTimeout(a,1300):setTimeout(a,1))};a()},appendTo:function(a){i.width(33*j.length+1).appendTo(a)}};return r}function b(a){var b=$('<div class="pal-center-char">&nbsp;</div>'),c=$('<div class="pal-center-size"></div>'),d=$('<div class="pal-center">').append(b).append(c);return a!=" "&&b.text(a).addClass("filled"),{node:d,"char":a,setSize:function(a){c.text(a).addClass("filled")},getPosition:function(){var a=b.position(),c=b.width(),d=b.height();return{x1:a.left,x2:a.left+c,y1:a.top,y2:a.top+d,w:c,h:d}},good:function(a){b.animate({backgroundColor:"#6E6"}).animate({backgroundColor:"#fff"})},bad:function(a){b.animate({backgroundColor:"#f44"}).animate({backgroundColor:"#fff"})}}}function c(){var a=$('<div class="pal-center-indicator">&#9671;</div>');return{node:a,point:function(b,c){b=b.getPosition();var d=c?b.x2+2:b.x1+b.w/2;a.animate({left:d-a.width()/2,top:b.y1-a.height()},a.is(":visible")?300:0).show()}}}function d(){var a=$('<div class="pal-expander">'),b={node:a,moveTo:function(b,c){b=b.getPosition(),c=c.getPosition(),a.animate({left:b.x1,top:b.y1,width:c.x2-b.x1,height:b.h},a.is(":visible")?300:0,"easeOutBack").show()}};return b}function e(){var a=$('<div class="pal-longest-match">'),b={node:a,moveTo:function(b,c){b=b.getPosition(),c=c.getPosition(),a.animate({left:b.x1,top:b.y2,width:c.x2-b.x1},a.is(":visible")?300:0,"easeOutBack").show()}};return b}window.RecordPlayer=a})()